<!--
  Menu menu Icones pour Design Nextdom et Jeedom (@noodom) 
  proposé par @esso1 (https://codepen.io/marcobiedermann/pen/aZZQww/)

  - Copier le contenu du répertoire https://github.com/NextDom/nextdom-theme-design/tree/master/menuIcones/themes sous /var/www/html/data/custom/themes pour Nextdom ou /var/www/html/montheme/themes pour Jeedom
  - Dans le mode Design, créer un design pour le menu (dans la configuration du design, positionner la largeur de vos pages Design)
  - Passer en mode Edition dans le design, puis ajouter "Texte/html" et copier/coller ce code HTML
  - Modifier les paramètres d'affichage du Text/html : Position X=0, Position Y=0, Largeur=largeur de vos pages Design, Hauteur=500
  - Dans le code HTML ci-dessous, faire les modifications suivantes après la ligne // *** DEBUT DES MODIFICATIONS PAR L'UTILISATEUR *** :
    - Modifier le contenu du Json pour adapter le contenu à ses besoins (variable json_theme, voir détail du contenu ci-dessous)
      Penser à mettre à jour pathData si nécessaire : "data/custom" par défaut", "montheme" pour Jeedom par exemple : vérifier les droits d'accès
-->

<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <title>Icon Navigation</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body class="align">

    <nav id="menu" class="navigation navigation--inline">
        <!-- Génération dynamique du menu depuis le json de configuration -->
    </nav>

    <div id="content" class="content" style="padding: 0px">
        <div id="i_frame">
            <!-- Div pour inclure les écrans de design dans une iframe -->
        </div>
    </div>

    <script language="javascript">
        // Valeurs par défaut (valeurs utilisées si non précisées dans le json de configuration ci-dessous)
        // A modifier seulement en connaissance de cause : il est préférable d'utiliser le paramétrage Json
        // *** NE PAS MODIFIER ***
        var defaultFrameTop = "30px";
        var defaultFrameWidth = "1280px";
        var defaultFrameHeight = "768px";
        var waitForLoadingFrame = 1; // ms
        var defaultPathData = "data/custom";

        // pour chaque item du menu renseigner les différents champs :
        // - label : libellé du champ à afficher dans le menu
        // - link : identifiant du design destinataire du lien du menu
        // - icon : icône svg à afficher pour l'item du menu
        //
        // Gestion des liens dans une iframe : mettre iframe à yes et définir ses position (Top), largeur et hauteur
        // - "iframe": "yes"
        // - "frameTop": "0px"
        // - "frameWidth": "1024px"
        // - "frameHeight": "580px"
        //
        // JSON de configuration à modifier pour personnaliser son menu :
        // *************************************************
        // *** DEBUT DES MODIFICATIONS PAR L'UTILISATEUR ***
        // *************************************************
        var json_theme = {
            "page": [{
                    "label": "Home",
                    "link": "91",
                    "icon": "home"
                },
                {
                    "label": "Search",
                    "link": "92",
                    "icon": "search",
                },
                {
                    "label": "Products",
                    "link": "93",
                    "icon": "cart"
                },
                {
                    "label": "Notifications",
                    "link": "94",
                    "icon": "bell"
                },
                {
                    "label": "Profile",
                    "link": "95",
                    "icon": "user"
                }
            ],
            "iframe": "yes", // (facultatif) gestion de la navigation par frame
            "frameTop": "30px", // (facultatif) position top de la frame
            "frameWidth": "1280px", // (facultatif) largeur de la frame
            "frameHeight": "768px", // (facultatif) hauteur de la frame
            "timeout": "1", // (facultatif) temps d'attente (en ms) avant chargement de la frame au lancement du menu (0 : pas de chargement au lancement)
            "pathData" : "data/custom" // (facultatif) définition du path pour la récupération des fichiers du menu et des icônes
        }

        // ***********************************************
        // *** FIN DES MODIFICATIONS par l'utilisateur ***
        // ***********************************************

        // récupération du path
        var pathData = defaultPathData;

        if (typeof (json_theme["pathData"]) !== "undefined") {
            pathData = json_theme["pathData"];
        }
        
        let link = document.createElement('link');
        link.setAttribute('rel', 'stylesheet');
        link.setAttribute('type', 'text/css');
        // décommenter la ligne ci-dessous et commenter la ligne suivante pour forcer le chargement du css (en cas de modification)
        //link.setAttribute('href', pathData + '/themes/menuIcones/css/style.css?v=' + (new Date()).getTime());
        link.setAttribute('href', pathData + '/themes/menuIcones/css/style.css');
        document.getElementsByTagName('head')[0].appendChild(link);

        function loadFrame() {
            if ((typeof json_theme["iframe"] !== undefined) && (json_theme["iframe"] === "yes")) {
                gotoPlan(homeLink);
            }
        }

        $(document).ready(function () {
            // gestion par frame : affichage du premier lien au chargement
            if (waitForLoadingFrame != 0) {
                setTimeout(loadFrame, waitForLoadingFrame);
            }
        });

        // url de page d'accueil (premier lien du menu récupéré dynamiquement)
        var homeLink = "";

        function getUrlDestination(urlParam) {
            if (isNaN(urlParam)) {
                return urlParam;
            } else {
                return 'index.php?v=d&p=plan&plan_id=' + urlParam + '&fullscreen=1';
            }
        }

        // Affichage du plan idPlan
        function gotoPlan(idPlan) {
            let frame_destination = document.getElementById('iframe_a');
            let urlDestination = getUrlDestination(idPlan);

            if (isNaN(idPlan)) {
                // url externe
                window.open(urlDestination, '_blank');
            } else {
                if (frame_destination === null) {
                    // pas de frame
                    if (window.location.href.split('?')[1] != urlDestination.split('?')[1]) {
                        window.location.href = urlDestination;
                    }
                } 
                else {
                    // gestion de la navigation par frame
                    if (frame_destination.src.split('?')[1] != urlDestination.split('?')[1]) {
                        frame_destination.src = urlDestination;
                    }
                }
            }
        }

        function createThemeSlidingMenu() {
            // récupération du temps d'attente pour le chargement de la frame au chargement de la page (en ms)
            if ((typeof json_theme["timeout"] !== undefined) && !isNaN(json_theme["timeout"])) {
                waitForLoadingFrame = json_theme["timeout"];
            }

            // creation de la frame
            let menu_id = document.getElementById('i_frame');

            if ((typeof json_theme["iframe"] !== undefined) && (json_theme["iframe"] === "yes")) {
                // position de l'iframe
                let menu_content_style = "padding: 15px 0px 0px; z-index: 10; position: absolute;";
                let frameTop = defaultFrameTop;

                if (typeof (json_theme["frameTop"]) !== "undefined") {
                    frameTop = json_theme["frameTop"]
                }

                let menu_content = document.getElementById('content');
                menu_content.style = "padding: 15px 0px 0px; z-index: 10; position: absolute; top: " + frameTop;

                // iframe pour afficher la page courante
                let menu_f = document.createElement("div");
                menu_f.className = "menuf";

                let menu_iframe = document.createElement("iframe");
                menu_iframe.id = "iframe_a";

                let frameWidth = defaultFrameWidth;
                if (typeof (json_theme["frameWidth"]) !== "undefined") {
                    frameWidth = json_theme["frameWidth"];
                }
                menu_iframe.width = frameWidth;

                let frameHeight = defaultFrameHeight;
                if (typeof (json_theme["frameHeight"]) !== "undefined") {
                    frameHeight = json_theme["frameHeight"];
                }
                menu_iframe.height = frameHeight;

                menu_iframe.frameBorder = "0";
                menu_iframe.scrolling = "no";
                menu_iframe.src = "";

                menu_f.appendChild(menu_iframe);
                menu_id.appendChild(menu_f);
            }

            // construction du menu
            let menu = document.getElementById("menu");
            let menu_ul = document.createElement("ul");
            menu.appendChild(menu_ul);

            for (let i = 0; i < json_theme["page"].length; i++) {
                let menu_item = document.createElement("li");
                let menu_item_a = document.createElement("a");

                let link = json_theme["page"][i]["link"];
                if (homeLink === "") {
                    homeLink = link;
                }

                menu_item_a.setAttribute("href", "#");
                menu_item_a.setAttribute("onclick", "gotoPlan(" + link + ")");
                menu_item_a.innerHTML =
                    ' <svg class="icon icon--2x">'
                    + ' <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#' + json_theme["page"][i]["icon"] + '">'
                    + '     <span class="invisible">'
                    +           json_theme["page"][i]["label"]
                    + '     </span>';
                menu_item.appendChild(menu_item_a);
                menu_ul.appendChild(menu_item);
            }
            menu.appendChild(menu_ul);
        }

        // création dynamique du menu Sliding menu
        createThemeSlidingMenu();

    </script>
    
    <svg xmlns="http://www.w3.org/2000/svg" class="icons">
        <symbol id="bell" viewBox="0 0 92 92">
            <path d="M84 71.5c-6.7 0-9.3-3.9-9.3-28.4 0-19.2-8.7-31.2-23.7-33v-6.2c0-2.2-1.8-4-4-4s-4 1.8-4 4v6c-16 1.3-25.3 13.5-25.3 33.1 0 24.5-2.9 28.4-9.7 28.4-2.1.1-4 1.6-4 3.8 0 2.3 1.8 3.8 4 3.8h26c.3 3 1.2 6.7 3.6 9.3 2.1 2.3 4.9 3.6 8.2 3.6 3.3 0 6.1-1.4 8.2-3.6 2.5-2.7 3.5-6.3 3.9-9.3h26.1c2.2 0 4-1.5 4-3.8 0-2.2-1.8-3.7-4-3.7zm-35.8 11.4c-.4.4-1 1-2.4 1-1.3 0-1.9-.6-2.3-1-.7-.9-1.2-1.9-1.4-3.9h7.8999999999999995c-.4 2-.9 3-1.8 3.9zm-1.6-11.9h-24.8c3.7-7 3.7-17.9 3.7-28.1 0-16.3 7.1-24.9 19.9-24.9h1.1c12.8 0 19.9 8.6 19.9 24.9 0 10.2 0 21.1 3.7 28.1h-23.5zm14.2-35.5c.1 1.9-1.4 3.6-3.3 3.7h-.2c-1.8 0-3.4-1.4-3.5-3.3-.3-4.5-3.8-6.1-4.2-6.3-1.8-.8-2.6-2.8-1.9-4.6.7-1.8 2.7-2.6 4.5-1.9.4.2 8.1 3.4 8.6 12.4z" />
        </symbol>
        <symbol id="cart" viewBox="0 0 92 92">
            <path d="M91.8 27.3l-10.7 33.7c-.8 2.4-2.9 4-5.4 4h-41.3c-2.4 0-4.7-1.5-5.5-3.7l-15.8-42.3h-9.1c-2.2 0-4-1.8-4-4s1.8-4 4-4h11.9c1.7 0 3.2 1.1 3.8 2.7l16.3 43.3h38l8.5-27h-47.1c-2.2 0-4-1.8-4-4s1.8-4 4-4h52.6c1.3 0 2.5.7 3.2 1.7.8 1 1 2.4.6 3.6zm-55.4 43c-1.7 0-3.4.7-4.6 1.9-1.2 1.2-1.9 2.9-1.9 4.6 0 1.7.7 3.4 1.9 4.6 1.2 1.2 2.9 1.9 4.6 1.9s3.4-.7 4.6-1.9c1.2-1.2 1.9-2.9 1.9-4.6 0-1.7-.7-3.4-1.9-4.6-1.2-1.2-2.9-1.9-4.6-1.9zm35.9 0c-1.7 0-3.4.7-4.6 1.9s-1.9 2.9-1.9 4.6c0 1.7.7 3.4 1.9 4.6 1.2 1.2 2.9 1.9 4.6 1.9 1.7 0 3.4-.7 4.6-1.9 1.2-1.2 1.9-2.9 1.9-4.6 0-1.7-.7-3.4-1.9-4.6s-2.9-1.9-4.6-1.9z" />
        </symbol>
        <symbol id="home" viewBox="0 0 92 92">
            <path d="M88 49c-1 0-2-.4-2.8-1.1l-39.2-38.3-39.2 38.3c-1.6 1.5-4.1 1.5-5.7-.1-1.5-1.6-1.5-4.1.1-5.7l42-41c1.6-1.5 4-1.5 5.6 0l42 41c1.6 1.5 1.6 4.1.1 5.7-.8.8-1.9 1.2-2.9 1.2zm-8.8 39v-39.1c0-2.2-1.8-4-4-4s-4 1.8-4 4v35.1h-12.5v-21.4c0-2.9-2.4-5.3-5.3-5.3h-14.8c-2.9 0-5.3 2.4-5.3 5.3v21.4h-12.5v-35.1c0-2.2-1.8-4-4-4s-4 1.8-4 4v39.1c0 2.2 1.8 4 4 4h20.5c2.2 0 4-1.8 4-4v-22.7h9.5v22.7c0 2.2 1.8 4 4 4h20.5c2.2 0 3.9-1.8 3.9-4z" />
        </symbol>
        <symbol id="search" viewBox="0 0 92 92">
            <path d="M57.8 2.2c-17.1 0-31 14.1-31 31.3 0 7.3 2.5 13.9 6.6 19.3l-29.4 29.8c-1.7 1.8-1.7 4.6 0 6.3.9.9 2 1.3 3.1 1.3 1.2 0 2.3-.4 3.2-1.3l29.4-29.8c5.1 3.7 11.3 5.8 18 5.8 17.1 0 31-14.1 31-31.3s-13.8-31.4-30.9-31.4zm0 54.8c-12.7 0-23-10.5-23-23.4 0-12.9 10.3-23.4 23-23.4s23 10.5 23 23.4c0 12.9-10.3 23.4-23 23.4zm15.5-23c-.2 1.7-1.7 3-3.4 3h-.5c-1.9-.3-3.2-2-3-3.9.7-5.2-5.1-7.9-5.4-8-1.7-.8-2.5-2.9-1.7-4.6s2.8-2.5 4.6-1.8c.4.1 10.8 4.9 9.4 15.3zm-7.3 7.6c.7.7 1.2 1.8 1.2 2.8 0 1.1-.4 2.1-1.2 2.8-.7.7-1.8 1.2-2.8 1.2-1 0-2.1-.4-2.8-1.2-.7-.7-1.2-1.8-1.2-2.8 0-1 .4-2.1 1.2-2.8.7-.7 1.8-1.2 2.8-1.2 1 0 2 .4 2.8 1.2z" />
        </symbol>
        <symbol id="user" viewBox="0 0 92 92">
            <path d="M46 57.1c14.8 0 26.9-12.1 26.9-27 0-15-12.1-27.1-26.9-27.1s-26.9 12.1-26.9 27c0 15 12.1 27.1 26.9 27.1zm0-46.1c10.4 0 18.9 8.5 18.9 19s-8.5 19-18.9 19-18.9-8.5-18.9-19 8.5-19 18.9-19zm12.5 48.7c-1.3-.4-2.8-.1-3.8.8l-8.7 7.4-8.7-7.4c-1.1-.9-2.5-1.2-3.8-.8-5.6 1.8-33.5 11.4-33.5 25.3 0 2.2 1.8 4 4 4h84c2.2 0 4-1.8 4-4 0-13.9-27.9-23.5-33.5-25.3zm-48.4 21.3c4.4-4.7 15-9.9 23.8-12.9l9.5 8.1c1.5 1.3 3.7 1.3 5.2 0l9.5-8.1c8.8 3.1 19.4 8.3 23.8 12.9h-71.8z" />
        </symbol>
    </svg>

</body>

</html>
